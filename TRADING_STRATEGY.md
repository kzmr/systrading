# 自動トレーディング戦略

## 概要

**現在運用中**: RSI逆張り戦略（XRP/JPY, BTC/JPY, ETH/JPY）
**取引所**: GMOコイン
**実行頻度**: 1分ごと自動実行

---

## 運用中の戦略

### RSI逆張り戦略（RSIContrarianStrategy）【メイン】

RSI（相対力指数）を使った逆張り戦略。売られすぎ・買われすぎの水準で反転を狙う。

#### エントリー条件

| 条件 | ロング | ショート |
|------|--------|----------|
| RSI | < 30（売られすぎ） | > 70（買われすぎ） |
| スプレッド | 0.1%以内 | 0.1%以内 |
| ポジション | 上限未達 | 上限未達 |

#### 決済条件

1. **RSI利確**: ロング時RSI≥50、ショート時RSI≤50
2. **タイムアウト**: 60分経過で強制決済
3. **損切り**: 1%逆行で強制決済
4. **トレーリングストップ**: 利益方向に追跡

#### パラメータ

| パラメータ | XRP | BTC | ETH |
|-----------|-----|-----|-----|
| rsi_period | 60 | 60 | 60 |
| rsi_oversold | 30 | 30 | 30 |
| rsi_overbought | 70 | 70 | 70 |
| trade_size | 1 | 0.001 | 0.01 |
| max_positions | 1 | 1 | 1 |
| max_hold_minutes | 60 | 60 | 60 |

---

### 高値安値ブレイクアウト戦略（HighLowBreakoutStrategy）

過去N本の価格レンジをブレイクした時にエントリー。トレンドフォロー型。

#### エントリー条件

- **ロング**: 現在価格 > 過去20本の最高値 × 1.004（0.4%ブレイク）
- **ショート**: 現在価格 < 過去20本の最安値 × 0.996

#### 決済条件

1. **逆方向ブレイク**: 全ポジション一斉決済 + 逆方向エントリー
2. **損切り**: 1%逆行で強制決済
3. **トレーリングストップ**: 利益方向に追跡

#### パラメータ

| パラメータ | 設定値 |
|-----------|--------|
| lookback_period | 20 |
| breakout_threshold | 0.4% |
| max_positions | 3 |

---

## 共通リスク管理機能

### 1. 固定損切り（1%）
- エントリー価格から1%逆行で強制決済
- 全戦略・全ポジションに適用

### 2. トレーリングストップ
- 初期: エントリー価格 ± 0.7%
- 追跡: 現在価格 ± 0.5%（利益方向のみ更新）
- 全戦略・全ポジションに適用

### 3. スプレッドチェック
- 新規エントリー時のみチェック（0.1%上限）
- 決済時はチェックなし（即座に執行）

---

## マルチ戦略運用

同一通貨ペアで複数戦略を運用可能：

- 各戦略は`trading_settings_id`で自分のポジションを識別
- 戦略ベース決済（RSI利確等）は自分のポジションのみ対象
- 損切り・トレーリングは全ポジションに適用

---

## 実行コマンド

```bash
# システム起動
php artisan schedule:work

# システム停止
pkill -f schedule:work

# 手動実行（テスト用）
php artisan trading:execute

# ポジション確認
./show_current_positions.sh

# ログ確認
./show_trading_logs.sh
```

---

**最終更新**: 2025-12-15
**バージョン**: v2.0（RSI逆張り戦略追加、マルチ戦略対応）
